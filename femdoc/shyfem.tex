
%------------------------------------------------------------------------
%
%    Copyright (C) 1985-2018  Georg Umgiesser
%
%    This file is part of SHYFEM.
%
%    SHYFEM is free software: you can redistribute it and/or modify
%    it under the terms of the GNU General Public License as published by
%    the Free Software Foundation, either version 3 of the License, or
%    (at your option) any later version.
%
%    SHYFEM is distributed in the hope that it will be useful,
%    but WITHOUT ANY WARRANTY; without even the implied warranty of
%    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
%    GNU General Public License for more details.
%
%    You should have received a copy of the GNU General Public License
%    along with SHYFEM. Please see the file COPYING in the main directory.
%    If not, see <http://www.gnu.org/licenses/>.
%
%    Contributions to this file can be found below in the revision log.
%
%------------------------------------------------------------------------

% $Id$

\documentclass{report}
%\documentclass[draft]{report}

\usepackage{a4}
\usepackage{shortvrb}
\usepackage{pslatex}

\usepackage{verbatim}
\usepackage{alltt}		% as verbatim, but interpret \ { }

\newenvironment{code}{\verbatim}{\endverbatim}
\newenvironment{codem}{\alltt}{\endalltt}	%interpret \
\newcommand{\ttt}[1]{{\tt #1}}

\newcommand{\shy}{{\tt SHYFEM}}
\newcommand{\shyfem}{{\tt SHYFEM}}
\newcommand{\psp}{{\tt SHYFEM}}

\input{P_version.tex}
\newcommand{\shyname}{shyfem-\version}
\newcommand{\shydist}{\shyname.tar.gz}
\newcommand{\basedir}{/home/model}
\newcommand{\shydir}{\basedir/shyfem-\version}

\newcommand{\descrpsep}{\vspace{0.2cm}}
\newcommand{\descrpitem}[1]{\descrpsep\parbox[t]{2cm}{#1}}
\newcommand{\descrptext}[1]{\parbox[t]{8cm}{#1}\descrpsep}
\newcommand{\descrp}[1]{\descrpsep\parbox[t]{4cm}{#1}}
\newcommand{\descrpn}[1]{\parbox[t]{4cm}{#1}}

\newcommand{\densityunit}{kg\,m${}^{-3}$}
\newcommand{\accelunit}{m\,s${}^{-2}$}
\newcommand{\maccelunit}{m${}^{4}$\,s${}^{-2}$}
\newcommand{\dischargeunit}{m${}^3$\,s${}^{-1}$}

\newcommand{\ten}[1]{$\cdot 10^{#1}$}
\newcommand{\degrees}{${}^o$}

\newcommand{\figref}[1]{\ref{fig:#1}}
\newcommand{\Fig}{Fig.~}

\newcommand{\todo}[1]{This section still has to be written by #1}

\parindent 0cm

\newcommand{\importstr}[2]{%
\begin{figure}
\begin{alltt}
\input{#1.str}
\end{alltt}
\caption{#2}
\label{fig:#1}
\end{figure}
}

\MakeShortVerb{\|}

\hyphenation{ ba-thy-me-try stop-ped sim-u-la-ted }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% front matter

\title{%
	\shy{} 
	\\Finite Element Model for Coastal Seas
	\\~
	\\User Manual
	}

\author{%
	The SHYFEM Group
	\\Georg Umgiesser
	\\Oceanography, ISMAR-CNR
	\\Arsenale Tesa 104, Castello 2737/F
	\\30122 Venezia, Italy
	\vspace{0.5cm}
	\\georg.umgiesser@ismar.cnr.it
	\vspace{1cm}
	\\Version \VERSION
	}

%\address{ISDGM-CNR}

%\date{}		%uncomment for no date

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% document

\begin{document}

\bibliographystyle{plain}

\pagenumbering{roman}
\pagestyle{plain}

\maketitle

%\begin{abstract}
% to be written
%\end{abstract}

\thispagestyle{empty}

\newpage
\tableofcontents
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter*{Disclaimer}
	\addcontentsline{toc}{chapter}{Disclaimer}

	\input{disclaimer}

\newpage
\pagenumbering{arabic}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% external software
% contributors

\chapter{Overview}

	\section{What is it}
	\input{over_what}

	%\section{Why use it}
	%\todo{Georg}

	%\section{How to use it}
	%\todo{Georg}

	\section{Where and how to get it}
	\input{git}

	%\section{Features}
	%\todo{Georg}

	%\section{License}
	%\todo{Georg}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Installing SHYFEM}

	\section{Downloading and unpacking}
	\input{download}

	\section{Needed software}
	\input{software}

	\section{Installation}
	\input{installation}

	\section{Compilation}
	\input{compilation}

	\section{Compatibility problems}
	\input{compatibility}

	\section{Compilation options}
	\input{summary_installing}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Preprocessing: The numerical grid}

	\section{Overview}
	\input{grid_overview}

	\section{Coastline and bathymetry}
	\input{grid_convert}

	\section{Boundary line: smoothing and reducing}
	\input{grid_reduce}

%	\section{Other information}
%	\input{grid_else}

	\section{Manipulating nodes, lines and elements: the grid program}
	\input{grid_prg}

	\section{Creating the mesh}
	\input{creating_mesh}

	\section{Interpolating the bathymetry into the grd file}
	\input{bathy_interp}

	\section{Creating the bas file}
	\input{pre_basin}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Running SHYFEM}

	\input{running_shyfem}

	\section{The parameter input file (str)}
	\input{model_how_to_run}

%	\section{Adjusting to the basin}
%	\todo{Georg}

%	\section{Basic file formats}
%	\todo{Georg}

	\section{Basic usage}

		\input{basic_usage}

		\subsection{Minimal simulation}
		\input{basic_minimal}

%		\input{usage.tex}	%??

		\subsection{Boundary conditions}
		\input{bound_cond}

%		\subsection{Writing output}
%		\todo{Georg}

%		\subsection{Simulating passive tracers}
%		\todo{Georg}

%		\subsection{Temperature and salinity}
%		\todo{Georg}

%		\subsection{Linear and non-linear simulations}
%		\todo{Georg}

%		\subsection{Coriolis force}
%		\todo{Georg}

		\subsection{Wind forcing}
		\input{wind_forcing}

	\section{Advanced usage}

		\subsection{Variable time step}
		\input{var_time_step}

		\subsection{3D computations}
		\input{3d_layers}

		\subsection{Baroclinic terms}
		\input{barocl}

		\subsection{Restart}
		\input{restart}

		\subsection{Turbulence}
		\input{turbulence}

		\subsection{Sediment transport}
		\input{sediment}

		\subsection{Wind waves}
		\input{S_wave}

		\subsection{Tidal potential}
		\input{S_tide}

		\subsection{Meteo forcing}
		\input{meteo_forcing}

		\subsection{Lagrangian particle module}
		\input{lagrangian}

%		\subsection{Large grids and projections}
%		\todo{Debora}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\chapter{Other modules}

%	\section{Residence times}
%	\todo{Andrea}

%	\section{Ecological module (EUTRO)}
%	\todo{Michol (c'e' gia' una descrizione di Donata)}

%	\input{bio3d.tex}
%	\subsection{Parameters for the Water Quality Module}
%	\input{S_biopar_h.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\chapter{Postprocessing}
%
% Da qui in poi ci pensiamo piu' tardi...
%
%\section{Running the post processing routines}
%\section{Time series: gnuplot}
%\section{Plotting spatial data: plots}
%	\subsection{Basic usage}
%	\subsection{Advanced usage}
%\section{Exporting data}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\chapter{Final thoughts}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\appendix


\chapter{Hydrodynamic equations and resolution techniques}

	\input{equat.tex}

\chapter{File formats}
\label{file_formats}

%	\section{STR file}

	\section{GRD file}
	\input{grd_format}

%	\section{Time series}

%	\section{Output file formats}





\chapter{Parameter list}


\section{Parameter list for the SHYFEM model}


\subsection{Section {\tt \$title}}

This section must be always the first section in the parameter input file.
It contains only three lines. An example is given in 
figure \ref{fig:titleexample}.

\begin{figure}[ht]
\begin{verbatim}
$title
        free one line description of simulation
        name_of_simulation
        name_of_basin
$end
\end{verbatim}
\caption{Example of section {\tt \$title}}
\label{fig:titleexample}
\end{figure}

The first line of this section is a free one line description of
the simulation that is to be carried out. The next line contains
the name of the simulation.
All created files will use this name in the main part of the file name
with different extensions. Therefore the hydrodynamic output file
(extension |out|) will be named |name_of_simulation.out|.
The last line gives the name of the basin file to be used. This
is the pre-processed file of the basin with extension |bas|.
In our example the basin file |name_of_basin.bas| is used.

The directory where this files are read from or written to depends
on the settings in section {\tt \$name}. Using the default
the program will read from and write to the current directory.

\subsection{Section {\tt \$para}}

This section defines the general behavior of the simulation,
gives various constants of parameters and determines what
output files are written. In the following the meaning of
all possible parameters is given.

Note that the only compulsory parameters in this section are 
the ones that chose the duration of the simulation and the
integration time step. All other parameters are optional.

\input{S_para_h.tex}

\subsection{Section {\tt \$proj}}
\input{P_proj.tex}

\subsection{Section {\tt \$waves}}
\input{P_wave.tex}

\subsection{Section {\tt \$sedtr}}
\input{P_sediment.tex}

\subsection{Section {\tt \$wrt}}
\input{P_wrt.tex}

\subsection{Section {\tt \$lagrg}}
\input{P_lagrg.tex}

\subsection{Section {\tt \$name}}

In this sections names of directories or input files can be
given. All directories default to the current directory,
whereas all file names are empty, i.e., no input files are
given.

\input{S_name.tex}
\input{S_name_h.tex}

\subsection{Section {\tt \$bound}}

\input{S_bound.tex}


\subsection{Section {\tt \$wind}}

\input{S_wind.tex}



\subsection{Section {\tt \$extra}}

In this section the node numbers of so called ``extra'' points are given. 
These are points where water level and velocities are written to create
a time series that can be elaborated later. The output for these ``extra''
points consumes little memory and can be therefore written with a
much higher frequency (typically the same as the integration time step)
than the complete hydrodynamic output. The output is written
to file EXT.

The node numbers are specified in a free format on one ore more lines.
An example can be seen in figure \ref{fig:example}. No keywords
are expected in this section.


\subsection{Section {\tt \$flux}}

In this section transects are specified through which the discharge
of water is computed by the program and written to file FLX.
The transects are defined by their nodes through which they run.
All nodes in one transect must be adjacent, i.e., they must form a
continuous line in the FEM network.

The nodes of the transects are specified in free format. Between
two transects one or more 0's must be inserted. An example is given in
figure \ref{fig:fluxexample}.

\begin{figure}[ht]
\begin{verbatim}
$flux
	1001 1002 1004 0
	35 37 46 0 0 56 57 58 0
	407
	301
	435 0 89 87
$end
\end{verbatim}
\caption{Example of section {\tt \$flux}}
\label{fig:fluxexample}
\end{figure}

The example shows the definition of 5 transects. As can be seen, the 
nodes of the transects can be given on one line alone (first transect),
two transects on one line (transect 2 and 3), spread over more lines
(transect 4) and a last transect.



\section{Parameter list for the post processing routines}

The format of the parameter input file is the same as the one for
the main routine. Please see this section for more information
on the format of the parameter input file.

Some sections of the parameter input file are identical to the 
sections used in the main routine. For easier reference we will
repeat the possible parameters of these section here.






\subsection{Section {\tt \$title}}

This section must be always the first section in the parameter input file.
It contains only three lines. An example has been given already in 
figure \ref{fig:titleexample}.

The only difference with respect to the {\tt \$para} section of the main
routine is the first line. Here any description of the output can be used.
It is just a way to label the parameter file.  The other two line with
the name of simulation and the basin are used to open the files needed
for plotting.


\subsection{Section {\tt \$para}}

\input{S_para_a.tex}


\subsection{Section {\tt \$color}}

\input{S_color.tex}


\subsection{Section {\tt \$arrow}}

\input{S_arrow.tex}


\subsection{Section {\tt \$legend}}

\input{S_legend.tex}


\subsection{Section {\tt \$legvar}}

\input{S_legvar.tex}


\subsection{Section {\tt \$name}}

\input{S_name.tex}







\bibliography{abbrev,lag,sedi,lagra}
\addcontentsline{toc}{chapter}{Bibliography}



\end{document}




